<!-- <p id="notice"><%#= notice %></p> -->

<script src="//maps.google.com/maps/api/js?key=<%= ENV['MAPS_API_KEY'] %>"></script>
<script src="//cdn.rawgit.com/mahnunchik/markerclustererplus/master/dist/markerclusterer.min.js"></script>
<script src='//cdn.rawgit.com/printercu/google-maps-utility-library-v3-read-only/master/infobox/src/infobox_packed.js' type='text/javascript'></script>

<!-- <div class="event_page_content">
  <div class="event_page_background">
    <h1>Events</h1>
  </div>
</div> -->

<div id="event_here">
<%= content_for :navbar do %>
  <div class="event_page">
    <%= render partial: 'layouts/navbar' %>
    <div class="event_page_content">
      <div class="event_page_background">
        <h1>Events</h1>
      </div>
    </div>
  </div>
<% end %>

<br><br><br>
<div style='width: 800px; margin-left: 160px; margin-top: 10px; margin-bottom:20px;'>
      <div id="map" style='width: 1000px; height: 400px;'></div>
    </div>

    </div>
    <script type="text/javascript">
    handler = Gmaps.build('Google');
    handler.buildMap({ provider: {}, internal: {id: 'map'}}, function(){
      uluru = {"lat": <%= @event.latitude %>, "lng": <%= @event.longitude %>};
      markers = handler.addMarkers([
        {
          "picture": {
            "url": "http://people.mozilla.com/~faaborg/files/shiretoko/firefoxIcon/firefox-32.png",
            "width":  32,
            "height": 32
          },
          "infowindow": "Maps"
        }
      ]);
      var map = new google.maps.Map(document.getElementById('map'), {
              zoom: 14,
              center: uluru
            });
      var marker = new google.maps.Marker({
              position: uluru,
              map: map
            });
      handler.bounds.extendWith(markers);
      handler.fitMapToBounds();
    });
    </script>

<div style="margin-left: 160px; margin-right: 160px; margin-top: 40px; margin-bottom:40px;">
  <h3><%= @event.title %></h3>

  <p>
    by <%= @event.organizer %>
    <br>

    <br>
    <strong>Venue:</strong>
    <%= @event.venue %>
    <br>
 
    <strong>Date:</strong>
    <% if @event.start_date == @event.end_date %>
      <%= @event.start_date.strftime('%a, %d %b %Y') %> (1 day)
    <% else %>
      <%= @event.start_date.strftime('%a, %d %b %Y') %> - <%= @event.end_date.strftime('%a, %d %b %Y') %> (<%= (@event.start_date..@event.end_date).to_a.length %> days)
    <% end %>
    <br>
  
    <strong>Time:</strong>
    <%= @event.start_time.strftime('%I:%M %p') %> - <%= @event.end_time.strftime('%I:%M %p') %>
    <br>

    <br>
    <%= @event.description %>
  </p>

  <% if signed_in? %>
    <% if current_user.admin? %>
      <%= link_to 'Edit', edit_event_path(@event) %> |
      <%= link_to 'Back', events_path %> |
      <%= link_to 'Delete', event_path, method: :delete, data: { confirm: 'Are you sure?' } %>
    <% end %>
  <% end %>

</div>


<% if current_user.admin? %>

<div style="margin-left: 160px; margin-right: 160px; margin-top: 40px; margin-bottom:40px;">
  <h4>Attendees</h4>

  <%= form_tag(event_path, :method => "get", id: "search-form") do %>
  <div class="col-lg-6">
      <div class="input-group">
        <input type="text" class="form-control justify-content-center" placeholder="Find donor" name="email" <% params[:email] %>>
        <span class="input-group-btn justify-content-center">
          <button class="btn btn-secondary" type="submit">Go!</button>
        </span>
      </div>
    </div>
  </div>
  <br>
  <% end %>

  <div class="attendees_table">
  <% if @donors.present? %>
    <%= render partial: 'attendees/find' %>
  <% else %>
    <%= render partial: '/attendees/event' %>
  <% end %>
  </div>
<% end %>

<% end %>
        


